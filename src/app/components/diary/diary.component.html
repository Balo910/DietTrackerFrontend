<div class="diary-container">
  <h2>Dziennik żywieniowy - {{ currentDate | date:'dd.MM.yyyy' }}</h2>
  
  <div class="date-controls">
    <button (click)="changeDate(-1)">← Poprzedni</button>
    <input type="date" 
           [value]="currentDate | date:'yyyy-MM-dd'"
           (change)="setNewDate($event)" />
    <button (click)="changeDate(1)">Następny →</button>
  </div>

  @if (isLoading) {
    <div class="loading">Ładowanie...</div>
  } @else if (errorMessage) {
    <div class="error">{{ errorMessage }}</div>
  }

  @for (meal of diaries; track meal.mealType) {
    <div class="meal-card">
      <div class="meal-header">
        <h3>{{ meal.mealType }}</h3>
        <button (click)="openAddDialog(meal.mealType)">+ Dodaj</button>
      </div>
      
      @if (meal.foods.length === 0 && meal.fluids.length === 0) {
        <div class="empty-meal">Brak wpisów</div>
      }

      @for (food of meal.foods; track food.id) {
        <div class="entry food-entry">
          <span>{{ food.name }} ({{ food.calories }} kcal)</span>
          <button (click)="removeFood(meal.id, food.id)">×</button>
        </div>
      }

      @for (fluid of meal.fluids; track fluid.id) {
        <div class="entry fluid-entry">
          <span>{{ fluid.name }} ({{ fluid.amount }} ml)</span>
          <button (click)="removeFluid(meal.id, fluid.id)">×</button>
        </div>
      }
    </div>
  }

  <button class="back-btn" routerLink="/">Powrót</button>
</div>